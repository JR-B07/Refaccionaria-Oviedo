-- Crear tabla retiros_caja
CREATE TABLE IF NOT EXISTS retiros_caja (
    id INT AUTO_INCREMENT PRIMARY KEY,
    folio VARCHAR(50) NOT NULL UNIQUE,
    local_id INT NOT NULL,
    usuario_id INT NOT NULL,
    monto DECIMAL(12, 2) NOT NULL,
    fecha_retiro DATETIME DEFAULT CURRENT_TIMESTAMP,
    descripcion TEXT NOT NULL,
    fecha_creacion DATETIME DEFAULT CURRENT_TIMESTAMP,
    fecha_actualizacion DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (local_id) REFERENCES locales(id),
    FOREIGN KEY (usuario_id) REFERENCES usuarios(id),
    
    INDEX idx_folio (folio),
    INDEX idx_local_id (local_id),
    INDEX idx_fecha_retiro (fecha_retiro)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Insertar algunos retiros de ejemplo
INSERT INTO retiros_caja (folio, local_id, usuario_id, monto, descripcion, fecha_retiro) VALUES
('R-20260120-001', 1, 3, 4800.00, 'RETIRO GENERADO AUTOMATICO', '2026-01-20 12:32:24'),
('R-20260119-002', 1, 3, 5100.00, 'RETIRO GENERADO AUTOMATICO', '2026-01-19 14:19:23'),
('R-20260119-003', 1, 3, 5100.00, 'RETIRO GENERADO AUTOMATICO', '2026-01-19 11:56:55'),
('R-20260117-004', 1, 3, 4800.00, 'RETIRO GENERADO AUTOMATICO', '2026-01-17 09:34:12'),
('R-20260116-005', 1, 3, 4800.00, 'RETIRO GENERADO AUTOMATICO', '2026-01-16 14:37:33'),
('R-20260115-006', 1, 6, 4800.00, 'RETIRO GENERADO AUTOMATICO', '2026-01-15 12:04:42'),
('R-20260114-007', 1, 3, 4800.00, 'RETIRO GENERADO AUTOMATICO', '2026-01-14 16:06:14'),
('R-20260113-008', 1, 3, 5100.00, 'RETIRO GENERADO AUTOMATICO', '2026-01-13 15:34:31'),
('R-20260112-009', 1, 3, 5080.00, 'ANILLOS BASTIDORES AUTO', '2026-01-12 11:18:07'),
('R-20260112-010', 1, 3, 5080.00, 'PROD CASTROL', '2026-01-12 11:18:31');

SELECT 'Tabla retiros_caja creada e inicializada exitosamente' AS status;
